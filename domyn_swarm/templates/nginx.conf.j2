events {
    # resolve "worker_connections are not enough while connecting to upstream"
    # https://stackoverflow.com/questions/28265717/worker-connections-are-not-enough
    worker_connections 100000;
}

http {
    upstream llm {
    {%- for host in upstreams %}
        server {{ host }};
    {%- endfor %}
    }

    server {
        listen {{port}};

        location / {
            proxy_pass http://llm;
            proxy_read_timeout 300s;  # Increase this to 300 seconds (5 minutes)
            proxy_connect_timeout 60s;  # Increase this to 60 seconds (1 minute)
        }
    }
}
